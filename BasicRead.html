<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>Spreadsheet::BasicRead - Methods to easily read data from spreadsheets</title>
<link rev="made" href="mailto:" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#name">NAME</a></li>
	<li><a href="#description">DESCRIPTION</a></li>
	<li><a href="#synopsis">SYNOPSIS</a></li>
	<li><a href="#required_modules">REQUIRED MODULES</a></li>
	<li><a href="#methods">METHODS</a></li>
	<ul>

		<li><a href="#new">new</a></li>
		<li><a href="#getnextrow()"><code>getNextRow()</code></a></li>
		<li><a href="#numsheets()"><code>numSheets()</code></a></li>
		<li><a href="#openspreadsheet(filename)"><code>openSpreadsheet(fileName)</code></a></li>
		<li><a href="#currentsheetnum()"><code>currentSheetNum()</code></a></li>
		<li><a href="#currentsheetname()"><code>currentSheetName()</code></a></li>
		<li><a href="#setcurrentsheetnum(num)"><code>setCurrentSheetNum(num)</code></a></li>
		<li><a href="#getnextsheet()"><code>getNextSheet()</code></a></li>
		<li><a href="#getfirstsheet()"><code>getFirstSheet()</code></a></li>
		<li><a href="#cellvalue(row,_col)">cellValue(row, col)</a></li>
		<li><a href="#getfirstrow()"><code>getFirstRow()</code></a></li>
		<li><a href="#setheadingrow(rownumber)"><code>setHeadingRow(rowNumber)</code></a></li>
		<li><a href="#logexp(message)"><code>logexp(message)</code></a></li>
		<li><a href="#logmsg(debug,_message)">logmsg(debug, message)</a></li>
	</ul>

	<li><a href="#known_issues">KNOWN ISSUES</a></li>
	<li><a href="#see_also">SEE ALSO</a></li>
	<li><a href="#author">AUTHOR</a></li>
	<li><a href="#license">LICENSE</a></li>
	<li><a href="#cvs_id">CVS ID</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="name">NAME</a></h1>
<p>Spreadsheet::BasicRead - Methods to easily read data from spreadsheets</p>
<p>
</p>
<hr />
<h1><a name="description">DESCRIPTION</a></h1>
<p>Provides methods for simple reading of a Excel spreadsheet row
at a time returning the row as an array of column values.
Properties can be set so that blank rows are skipped</p>
<p>
</p>
<hr />
<h1><a name="synopsis">SYNOPSIS</a></h1>
<pre>
 use Spreadsheet::BasicRead;</pre>
<pre>
 my $xlsFileName = 'Test.xls';</pre>
<pre>
 my $ss = new Spreadsheet::BasicRead($xlsFileName) ||
        die &quot;Could not open '$xlsFileName': $!&quot;;</pre>
<pre>
 # Print the row number and data for each row of the
 # spreadsheet to stdout using '|' as a separator
 my $row = 0;
 while (my $data = $ss-&gt;getNextRow())
 {
        $row++;
        print join('|', $row, @$data), &quot;\n&quot;;
 }</pre>
<pre>
 # Print the number of sheets
 print &quot;There are &quot;, $ss-&gt;numSheets(), &quot; in the spreadsheet\n&quot;;</pre>
<pre>
 # Set the heading row to 4
 $ss-&gt;setHeadingRow(4);</pre>
<pre>
 # Skip the first data line, it's assumed to be a heading
 $ss-&gt;skipHeadings(1);</pre>
<pre>
 # Print the name of the current sheet
 print &quot;Sheet name is &quot;, $ss-&gt;currentSheetName(), &quot;\n&quot;;</pre>
<pre>
 # Reset back to the first row of the sheet
 $ss-&gt;getFirstRow();</pre>
<p>
</p>
<hr />
<h1><a name="required_modules">REQUIRED MODULES</a></h1>
<p>The following modules are required:</p>
<pre>
 Spreadsheet::ParseExcel</pre>
<p>Optional module File::Log can be used to allow simple logging of errors.</p>
<p>
</p>
<hr />
<h1><a name="methods">METHODS</a></h1>
<p>There are no class methods, the object methods are described below.
Private class method start with the underscore character '_' and
should be treated as <em>Private</em>.</p>
<p>
</p>
<h2><a name="new">new</a></h2>
<p>Called to create a new BasicReadNamedCol object.  The arguments can
be either a single string (see <a href="#synopsis">'SYNOPSIS'</a>)
which is taken as the filename of the spreadsheet of as named arguments.</p>
<pre>
 eg.  my $ss = Spreadsheet::BasicReadNamedCol-&gt;new(
                  fileName      =&gt; 'MyExcelSpreadSheet.xls',
                  skipHeadings  =&gt; 1,
                  skipBlankRows =&gt; 1,
                  log           =&gt; $log,
              );</pre>
<p>The following named arguments are available:</p>
<dl>
<dt><strong><a name="item_skipheadings">skipHeadings</a></strong><br />
</dt>
<dd>
Don't output the headings line in the first call to
<a href="#getnextrow">'getNextRow'</a> if true.
</dd>
<p></p>
<dt><strong><a name="item_skipblankrows">skipBlankRows</a></strong><br />
</dt>
<dd>
Skip blank lines in the spreadsheet if true.
</dd>
<p></p>
<dt><strong><a name="item_log">log</a></strong><br />
</dt>
<dd>
Use the File::Log object to log exceptions.
If not provided error conditions are logged to STDERR
</dd>
<p></p>
<dt><strong><a name="item_filename">fileName</a></strong><br />
</dt>
<dd>
The name (and optionally path) of the spreadsheet file to process.
</dd>
<p></p></dl>
<p>
</p>
<h2><a name="getnextrow()"><code>getNextRow()</code></a></h2>
<p>Get the next row of data from the spreadsheet.  The data is
returned as an array reference.</p>
<pre>
 eg.  $rowDataArrayRef = $ss-&gt;getNextRow();</pre>
<p>
</p>
<h2><a name="numsheets()"><code>numSheets()</code></a></h2>
<p>Returns the number of sheets in the spreadsheet</p>
<p>
</p>
<h2><a name="openspreadsheet(filename)"><code>openSpreadsheet(fileName)</code></a></h2>
<p>Open a new spreadsheet file and set the current sheet to the first
sheet.  The name and optionally path of the
spreadsheet file is a required argument to this method.</p>
<p>
</p>
<h2><a name="currentsheetnum()"><code>currentSheetNum()</code></a></h2>
<p>Returns the current sheet number or undef if there is no current sheet.
<a href="#setcurrentsheetnum">'setCurrentSheetNum'</a> can be called to set the
current sheet.</p>
<p>
</p>
<h2><a name="currentsheetname()"><code>currentSheetName()</code></a></h2>
<p>Return the name of the current sheet or undef if the current sheet is
not defined.  see <a href="#setcurrentsheetnum">'setCurrentSheetNum'</a>.</p>
<p>
</p>
<h2><a name="setcurrentsheetnum(num)"><code>setCurrentSheetNum(num)</code></a></h2>
<p>Sets the current sheet to the integer value 'num' passed as the required
argument to this method.  Note that this should not be bigger than
the value returned by <a href="#numsheets">'numSheets'</a>.</p>
<p>
</p>
<h2><a name="getnextsheet()"><code>getNextSheet()</code></a></h2>
<p>Returns the next sheet ``ssBook'' object or undef if there are no more sheets
to process.  If there is no current sheet defined the first sheet
is returned.</p>
<p>
</p>
<h2><a name="getfirstsheet()"><code>getFirstSheet()</code></a></h2>
<p>Returns the first sheet ``ssBook'' object.</p>
<p>
</p>
<h2><a name="cellvalue(row,_col)">cellValue(row, col)</a></h2>
<p>Returns the value of the cell defined by (row, col)in the current sheet.</p>
<p>
</p>
<h2><a name="getfirstrow()"><code>getFirstRow()</code></a></h2>
<p>Returns the first row of data from the spreadsheet (possibly skipping the
column headings  <a href="#new">'skipHeadings'</a>) as an array reference.</p>
<p>
</p>
<h2><a name="setheadingrow(rownumber)"><code>setHeadingRow(rowNumber)</code></a></h2>
<p>Sets the effective minimum row for the spreadsheet to 'rowNumber', since it
is assumed that the heading is on this row and anything above the heading is
not relavent.</p>
<p><strong>Note:</strong> the row (and column) numbers are zero indexed.</p>
<p>
</p>
<h2><a name="logexp(message)"><code>logexp(message)</code></a></h2>
<p>Logs an exception message (can be a list of strings) using the File::Log
object if it was defined and then calls die message.</p>
<p>
</p>
<h2><a name="logmsg(debug,_message)">logmsg(debug, message)</a></h2>
<p>If a File::Log object was passed as a named argument <a href="#new">'new'</a>) and
if 'debug' (integer value) is equal to or greater than the current debug
Level (see File::Log) then the message is added to the log file.</p>
<p>If a File::Log object was not passed to new then the message is output to
STDERR.</p>
<p>
</p>
<hr />
<h1><a name="known_issues">KNOWN ISSUES</a></h1>
<p>None, however please contact the author at <a href="mailto:gng@cpan.org">gng@cpan.org</a> should you
find any problems and I will endevour to resolve then as soon as
possible</p>
<p>
</p>
<hr />
<h1><a name="see_also">SEE ALSO</a></h1>
<p>Spreadsheet:ParseExcel on CPAN does all the hard work, thanks
Kawai Takanori (Hippo2000) <a href="mailto:kwitknr@cpan.org">kwitknr@cpan.org</a></p>
<p>
</p>
<hr />
<h1><a name="author">AUTHOR</a></h1>
<p>Greg George, IT Technology Solutions P/L, Australia
Mobile: +61-404-892-159, Email: <a href="mailto:gng@cpan.org">gng@cpan.org</a></p>
<p>
</p>
<hr />
<h1><a name="license">LICENSE</a></h1>
<p>Copyright (c) 1999- Greg George. All rights reserved. This
program is free software; you can redistribute it and/or modify it under
the same terms as Perl itself.</p>
<p>
</p>
<hr />
<h1><a name="cvs_id">CVS ID</a></h1>
<p>$Id$</p>

</body>

</html>
